Running GPU.
Training size: 50000, Validation size: 50000:60000, batch sizes: 100,neural_networs: 3, Epochs_ResNet: 3, Epochs_SuperLoop: 2
Epoch 0 : b_values [[0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]] 
losse
Epoch  1 : Train Loss 0.746744 , Train acc 0.983260, Valid acc 0.983500
Epoch  2 : Train Loss 0.196750
Epoch  3 : Train Loss 0.113326
Epoch  4 : Train Loss 0.083425 , Train acc 0.994700, Valid acc 0.990700
0.08342471012758323
Epoch  1 : Train Loss 0.739911 , Train acc 0.975840, Valid acc 0.979300
Epoch  2 : Train Loss 0.206513
Epoch  3 : Train Loss 0.116064
Epoch  4 : Train Loss 0.077070 , Train acc 0.990120, Valid acc 0.987000
0.07707028165008524
Epoch  1 : Train Loss 0.720609 , Train acc 0.983540, Valid acc 0.984700
Epoch  2 : Train Loss 0.191710
Epoch  3 : Train Loss 0.114319
Epoch  4 : Train Loss 0.081552 , Train acc 0.994140, Valid acc 0.990600
0.08155231848519179
avg 1
[array([0.08342471, 0.07707028, 0.08155232])]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[2 2 0 1]
 [2 0 2 1]
 [1 0 2 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[2 2 0 1]
 [2 0 2 1]
 [1 0 2 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[2 2 0 1]
 [2 0 2 1]
 [1 0 2 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[2 2 0 1]
 [2 0 2 1]
 [1 0 2 1]]
Epoch 1 : b_values [[0.3333327  0.33253502 0.33413228]
 [0.33585414 0.33332699 0.33081886]
 [0.33081886 0.33332699 0.33585414]
 [0.33333333 0.33333333 0.33333333]] 
losse
Epoch  1 : Train Loss 0.734847 , Train acc 0.957680, Valid acc 0.962400
Epoch  2 : Train Loss 0.200258
Epoch  3 : Train Loss 0.127788
Epoch  4 : Train Loss 0.082942 , Train acc 0.995340, Valid acc 0.992500
0.08294184646205395
Epoch  1 : Train Loss 0.803366 , Train acc 0.976780, Valid acc 0.978000
Epoch  2 : Train Loss 0.194792
Epoch  3 : Train Loss 0.120036
Epoch  4 : Train Loss 0.080503 , Train acc 0.991060, Valid acc 0.988000
0.08050271257641725
Epoch  1 : Train Loss 0.750186 , Train acc 0.982020, Valid acc 0.982800
Epoch  2 : Train Loss 0.189974
Epoch  3 : Train Loss 0.119090
Epoch  4 : Train Loss 0.078970 , Train acc 0.995580, Valid acc 0.992600
0.07896979050572554
avg 1
[array([ 0.03398848, -0.04477003,  0.01078155]), array([0.08294185, 0.08050271, 0.07896979])]
[-0.69315005 -0.69674175 -0.68955405]
[0.33333142 0.33213634 0.33453224]
[0. 0. 0.]
[[1 1 1 2]
 [2 1 1 0]
 [2 1 1 1]]
[-0.68182482 -0.6931757  -0.7044838 ]
[0.33711928 0.33331432 0.3295664 ]
[0. 0. 0.]
[[1 1 1 2]
 [2 1 1 0]
 [2 1 1 1]]
[-0.7044838  -0.6931757  -0.68182482]
[0.3295664  0.33331432 0.33711928]
[0. 0. 0.]
[[1 1 1 2]
 [2 1 1 0]
 [2 1 1 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[1 1 1 2]
 [2 1 1 0]
 [2 1 1 1]]
avg 2
[array([ 0.03398848, -0.04477003,  0.01078155]), array([ 0.02644724, -0.00373828, -0.02270896])]
Epoch  1 : Train Loss 0.722370 , Train acc 0.982300, Valid acc 0.982300
Epoch  2 : Train Loss 0.192491
Epoch  3 : Train Loss 0.115309
Epoch  4 : Train Loss 0.083087 , Train acc 0.995180, Valid acc 0.991200
--- 378.6535108089447 seconds ---
The final loss when training with the optimal layers is: 0.08308650975959608
avg_loss
[array([ 0.03398848, -0.04477003,  0.01078155]), array([ 0.02644724, -0.00373828, -0.02270896])]
b_print[i]
[[0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]]
[[0.3333327  0.33253502 0.33413228]
 [0.33585414 0.33332699 0.33081886]
 [0.33081886 0.33332699 0.33585414]
 [0.33333333 0.33333333 0.33333333]]
