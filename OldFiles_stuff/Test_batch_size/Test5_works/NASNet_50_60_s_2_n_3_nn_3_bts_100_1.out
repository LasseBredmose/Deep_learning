Running GPU.
Training size: 50000, Validation size: 50000:60000, batch sizes: 100,neural_networs: 3, Epochs_ResNet: 3, Epochs_SuperLoop: 2
Epoch 0 : b_values [[0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]] 
losse
Epoch  1 : Train Loss 0.700792 , Train acc 0.969320, Valid acc 0.969600
Epoch  2 : Train Loss 0.191462
Epoch  3 : Train Loss 0.107945
Epoch  4 : Train Loss 0.065128 , Train acc 0.993280, Valid acc 0.989900
0.06512777194846421
Epoch  1 : Train Loss 0.789744 , Train acc 0.981820, Valid acc 0.983800
Epoch  2 : Train Loss 0.206247
Epoch  3 : Train Loss 0.126920
Epoch  4 : Train Loss 0.092769 , Train acc 0.991240, Valid acc 0.988200
0.09276883858256042
Epoch  1 : Train Loss 0.788425 , Train acc 0.968060, Valid acc 0.967600
Epoch  2 : Train Loss 0.206833
Epoch  3 : Train Loss 0.123157
Epoch  4 : Train Loss 0.085586 , Train acc 0.993620, Valid acc 0.990300
0.0855859714903636
avg 1
[array([0.06512777, 0.09276884, 0.08558597])]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 2 0 1]
 [1 2 2 1]
 [1 2 2 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 2 0 1]
 [1 2 2 1]
 [1 2 2 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 2 0 1]
 [1 2 2 1]
 [1 2 2 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 2 0 1]
 [1 2 2 1]
 [1 2 2 1]]
Epoch 1 : b_values [[0.34806876 0.31881193 0.33311931]
 [0.33333333 0.33333333 0.33333333]
 [0.34806876 0.33311931 0.31881193]
 [0.33333333 0.33333333 0.33333333]] 
losse
Epoch  1 : Train Loss 0.744661 , Train acc 0.986180, Valid acc 0.985700
Epoch  2 : Train Loss 0.200916
Epoch  3 : Train Loss 0.116424
Epoch  4 : Train Loss 0.090126 , Train acc 0.992640, Valid acc 0.989400
0.09012593103747349
Epoch  1 : Train Loss 0.717901 , Train acc 0.981800, Valid acc 0.982100
Epoch  2 : Train Loss 0.180553
Epoch  3 : Train Loss 0.103198
Epoch  4 : Train Loss 0.075932 , Train acc 0.990780, Valid acc 0.989400
0.0759322497996618
Epoch  1 : Train Loss 0.753520 , Train acc 0.980360, Valid acc 0.980200
Epoch  2 : Train Loss 0.207299
Epoch  3 : Train Loss 0.128092
Epoch  4 : Train Loss 0.084264 , Train acc 0.995980, Valid acc 0.992200
0.08426431732077617
avg 1
[array([0.06512777, 0.09276884, 0.08558597]), array([0.09012593, 0.07593225, 0.08426432])]
[-0.62753904 -0.75923707 -0.69411045]
[0.35559326 0.31171507 0.33269167]
[0. 0. 0.]
[[2 1 1 2]
 [0 2 2 0]
 [1 2 2 2]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[2 1 1 2]
 [0 2 2 0]
 [1 2 2 2]]
[-0.62753904 -0.69411045 -0.75923707]
[0.35559326 0.33269167 0.31171507]
[0. 0. 0.]
[[2 1 1 2]
 [0 2 2 0]
 [1 2 2 2]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[2 1 1 2]
 [0 2 2 0]
 [1 2 2 2]]
avg 2
[array([0.06512777, 0.09276884, 0.08558597]), array([0.09012593, 0.07593225, 0.08426432])]
Epoch  1 : Train Loss 0.764697 , Train acc 0.967740, Valid acc 0.970200
Epoch  2 : Train Loss 0.180367
Epoch  3 : Train Loss 0.107993
Epoch  4 : Train Loss 0.069712 , Train acc 0.994900, Valid acc 0.990300
--- 393.1056032180786 seconds ---
The final loss when training with the optimal layers is: 0.06971232144802343
avg_loss
[array([0.06512777, 0.09276884, 0.08558597]), array([0.09012593, 0.07593225, 0.08426432])]
b_print[i]
[[0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]]
[[0.34806876 0.31881193 0.33311931]
 [0.33333333 0.33333333 0.33333333]
 [0.34806876 0.33311931 0.31881193]
 [0.33333333 0.33333333 0.33333333]]
