Running GPU.
Training size: 50000, Validation size: 50000:60000, batch sizes: 100,neural_networs: 3, Epochs_ResNet: 3, Epochs_SuperLoop: 2
Epoch 0 : b_values [[0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]] 
Epoch  1 : Train Loss 0.669948 , Train acc 0.987400, Valid acc 0.987300
Epoch  2 : Train Loss 0.171922
Epoch  3 : Train Loss 0.103686
Epoch  4 : Train Loss 0.069911 , Train acc 0.994300, Valid acc 0.990300
Epoch  1 : Train Loss 0.776800 , Train acc 0.965520, Valid acc 0.965000
Epoch  2 : Train Loss 0.225435
Epoch  3 : Train Loss 0.138869
Epoch  4 : Train Loss 0.097794 , Train acc 0.990840, Valid acc 0.987800
Epoch  1 : Train Loss 0.729824 , Train acc 0.976420, Valid acc 0.978800
Epoch  2 : Train Loss 0.185464
Epoch  3 : Train Loss 0.117984
Epoch  4 : Train Loss 0.081913 , Train acc 0.994660, Valid acc 0.990300
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 0 0 2]
 [2 2 2 2]
 [0 2 0 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 0 0 2]
 [2 2 2 2]
 [0 2 0 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 0 0 2]
 [2 2 2 2]
 [0 2 0 1]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 0 0 2]
 [2 2 2 2]
 [0 2 0 1]]
Epoch 1 : b_values [[0.34640101 0.33316474 0.32043424]
 [0.34523653 0.33319329 0.32157018]
 [0.34640101 0.33316474 0.32043424]
 [0.33333201 0.334485   0.33218299]] 
Epoch  1 : Train Loss 0.727922 , Train acc 0.987220, Valid acc 0.985000
Epoch  2 : Train Loss 0.195811
Epoch  3 : Train Loss 0.122579
Epoch  4 : Train Loss 0.090760 , Train acc 0.990260, Valid acc 0.986300
Epoch  1 : Train Loss 0.781372 , Train acc 0.980420, Valid acc 0.978800
Epoch  2 : Train Loss 0.206368
Epoch  3 : Train Loss 0.126121
Epoch  4 : Train Loss 0.081613 , Train acc 0.992320, Valid acc 0.988800
Epoch  1 : Train Loss 0.710213 , Train acc 0.977780, Valid acc 0.978800
Epoch  2 : Train Loss 0.186552
Epoch  3 : Train Loss 0.116060
Epoch  4 : Train Loss 0.074225 , Train acc 0.993780, Valid acc 0.988700
[-0.63489689 -0.69390593 -0.75177692]
[0.3530587  0.33282782 0.31411348]
[0. 0. 0.]
[[0 1 1 2]
 [2 2 1 2]
 [1 2 0 1]]
[-0.64004429 -0.69377742 -0.74656525]
[0.3512912  0.33291339 0.31579541]
[0. 0. 0.]
[[0 1 1 2]
 [2 2 1 2]
 [1 2 0 1]]
[-0.63489689 -0.69390593 -0.75177692]
[0.3530587  0.33282782 0.31411348]
[0. 0. 0.]
[[0 1 1 2]
 [2 2 1 2]
 [1 2 0 1]]
[-0.69315314 -0.68796913 -0.69832821]
[0.33332936 0.33506183 0.33160881]
[0. 0. 0.]
[[0 1 1 2]
 [2 2 1 2]
 [1 2 0 1]]
Epoch  1 : Train Loss 0.675525 , Train acc 0.985460, Valid acc 0.983000
Epoch  2 : Train Loss 0.180821
Epoch  3 : Train Loss 0.111727
Epoch  4 : Train Loss 0.063989 , Train acc 0.995660, Valid acc 0.990700
--- 416.8450722694397 seconds ---
The final loss when training with the optimal layers is: 0.06398852963859099
avg_loss
[array([-0.15978144,  0.17532005, -0.01553861]), array([ 0.10414357, -0.00713133, -0.09701224])]
b_print[i]
[[0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]]
[[0.34640101 0.33316474 0.32043424]
 [0.34523653 0.33319329 0.32157018]
 [0.34640101 0.33316474 0.32043424]
 [0.33333201 0.334485   0.33218299]]
Running GPU.
Training size: 50000, Validation size: 50000:60000, batch sizes: 100,neural_networs: 3, Epochs_ResNet: 3, Epochs_SuperLoop: 2
Epoch 0 : b_values [[0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]] 
losse
Epoch  1 : Train Loss 0.735546 , Train acc 0.978120, Valid acc 0.980000
Epoch  2 : Train Loss 0.192832
Epoch  3 : Train Loss 0.116565
Epoch  4 : Train Loss 0.079211 , Train acc 0.994820, Valid acc 0.992000
0.07921074271565885
Epoch  1 : Train Loss 0.704578 , Train acc 0.983140, Valid acc 0.983000
Epoch  2 : Train Loss 0.185363
Epoch  3 : Train Loss 0.101846
Epoch  4 : Train Loss 0.074488 , Train acc 0.994760, Valid acc 0.991700
0.0744882482169487
Epoch  1 : Train Loss 0.725516 , Train acc 0.981780, Valid acc 0.982600
Epoch  2 : Train Loss 0.206609
Epoch  3 : Train Loss 0.111596
Epoch  4 : Train Loss 0.080229 , Train acc 0.992540, Valid acc 0.990500
0.08022868579384522
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 2 1 2]
 [1 0 1 1]
 [2 0 0 2]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 2 1 2]
 [1 0 1 1]
 [2 0 0 2]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 2 1 2]
 [1 0 1 1]
 [2 0 0 2]]
[-0.69314718 -0.69314718 -0.69314718]
[0.33333333 0.33333333 0.33333333]
[0. 0. 0.]
[[0 2 1 2]
 [1 0 1 1]
 [2 0 0 2]]
Epoch 1 : b_values [[0.33215389 0.33665442 0.3311917 ]
 [0.33450708 0.33333196 0.33216096]
 [0.33119557 0.33547568 0.33332875]
 [0.33332236 0.33665189 0.33002575]] 
losse
Epoch  1 : Train Loss 0.772312 , Train acc 0.968660, Valid acc 0.968100
Epoch  2 : Train Loss 0.190636
Epoch  3 : Train Loss 0.116588
Epoch  4 : Train Loss 0.078408 , Train acc 0.991440, Valid acc 0.987500
0.0784077389643062
Epoch  1 : Train Loss 0.750916 , Train acc 0.967420, Valid acc 0.970200
Epoch  2 : Train Loss 0.181222
Epoch  3 : Train Loss 0.113597
Epoch  4 : Train Loss 0.071025 , Train acc 0.993380, Valid acc 0.989200
0.0710253637417918
Epoch  1 : Train Loss 0.735921 , Train acc 0.964240, Valid acc 0.964500
Epoch  2 : Train Loss 0.189479
Epoch  3 : Train Loss 0.116929
Epoch  4 : Train Loss 0.076213 , Train acc 0.993960, Valid acc 0.990700
0.07621292188530787
[-0.6984594  -0.67823916 -0.70280012]
[0.33155457 0.33832692 0.33011851]
[0. 0. 0.]
[[2 2 0 0]
 [1 0 1 0]
 [2 0 0 1]]
[-0.68786996 -0.69315337 -0.6984275 ]
[0.33509498 0.33332921 0.33157581]
[0. 0. 0.]
[[2 2 0 0]
 [1 0 1 0]
 [2 0 0 1]]
[-0.70278263 -0.68352203 -0.69316779]
[0.33013014 0.33655027 0.33331959]
[0. 0. 0.]
[[2 2 0 0]
 [1 0 1 0]
 [2 0 0 1]]
[-0.69319658 -0.67825046 -0.7080686 ]
[0.3333004  0.33831936 0.32838023]
[0. 0. 0.]
[[2 2 0 0]
 [1 0 1 0]
 [2 0 0 1]]
Epoch  1 : Train Loss 0.703443 , Train acc 0.981800, Valid acc 0.984300
Epoch  2 : Train Loss 0.172970
Epoch  3 : Train Loss 0.101938
Epoch  4 : Train Loss 0.073669 , Train acc 0.994700, Valid acc 0.991300
--- 339.084974527359 seconds ---
The final loss when training with the optimal layers is: 0.07366880973771912
avg_loss
[array([ 0.01583631, -0.04472721,  0.0288909 ]), array([ 0.04244343, -0.05570643,  0.01326299])]
b_print[i]
[[0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]
 [0.33333333 0.33333333 0.33333333]]
[[0.33215389 0.33665442 0.3311917 ]
 [0.33450708 0.33333196 0.33216096]
 [0.33119557 0.33547568 0.33332875]
 [0.33332236 0.33665189 0.33002575]]
